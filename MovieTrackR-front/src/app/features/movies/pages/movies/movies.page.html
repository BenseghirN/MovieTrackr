<div class="movies-page">
  <h1>üîç Recherche de films</h1>
  <div class="search-panel">
    <div class="search-bar">
      <input
        type="text"
        pInputText
        placeholder="Rechercher un film..."
        [value]="searchQuery()"
        (input)="onQueryChange($event)"
        (keyup)="onSearchKeyup($event)"
        class="search-input"
      />
      <p-button
        label="Rechercher"
        icon="pi pi-search"
        (click)="currentPage.set(1); search()"
        [loading]="loading()"
      ></p-button>
    </div>
    <div class="filters-row">
      <div class="filter-item">
        <label for="year">Ann√©e (optionnel)</label>
        <p-inputNumber
          id="year"
          [ngModel]="yearFilter()"
          (ngModelChange)="onYearChange($event)"
          placeholder="Ex: 2024"
          [useGrouping]="false"
          [min]="1900"
          [max]="2030"
        ></p-inputNumber>
      </div>
    </div>
  </div>

  @if (loading()) {
    <div class="loading-container">
      <p-progressSpinner></p-progressSpinner>
    </div>
  }

  @if (error()) {
    <div class="error-message">
      <i class="pi pi-exclamation-triangle"></i>
      {{ error() }}
    </div>
  }

  @if (showNoResults()) {
    <div class="no-results">
      <i class="pi pi-info-circle"></i>
      Aucun film trouv√© pour "{{ searchQuery() }}"
    </div>
  }

  @if (hasResults()) {
    <div class="results-info">
      <span>{{ totalResults() }} r√©sultat(s) trouv√©(s)</span>
    </div>

    <div 
      class="movies-grid">
      @for (movie of movies(); track movie.tmdbId) {
        <app-movie-card 
          [movie]="movie" 
          (movieClick)="onMovieClick(movie)"
        />
      }
    </div>

    <p-paginator
      [rows]="pageSize()"
      [totalRecords]="totalResults()"
      [first]="(currentPage() - 1) * pageSize()"
      [rowsPerPageOptions]="[10, 20, 50]"
      (onPageChange)="onPageChange($event)"
    ></p-paginator>
  }
</div>