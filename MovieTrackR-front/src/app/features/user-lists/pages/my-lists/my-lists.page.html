<div class="my-lists-page">
  <div class="page-header">
    <div class="header-content">
      <h1>Mes Listes</h1>
      <p class="subtitle">Organisez vos films en listes personnalisées</p>
    </div>
    
    @if (isAuthenticated()) {
      <p-button
        label="Créer une liste"
        icon="pi pi-plus"
        (onClick)="onCreateList()"
        styleClass="create-list-btn"
      />
    }
  </div>

  @if (loading()) {
    <div class="loading-container">
      <p-progressSpinner />
    </div>
  }

  @if (error()) {
    <div class="error-message">
      <i class="pi pi-exclamation-triangle"></i>
      <p>{{ error() }}</p>
      <p-button
        label="Réessayer"
        [outlined]="true"
        (onClick)="onLoadLists()"
      />
    </div>
  }

  @if (!loading() && !error()) {
    @if (hasLists()) {
      <div class="lists-grid">
        @for (list of lists(); track list.id) {
          <p-card 
            styleClass="list-card"
            (click)="onViewList(list)"
          >
            <ng-template pTemplate="header">
              <div class="card-header">
                <div class="list-icon">
                  <i class="pi pi-list"></i>
                </div>
                <div class="card-actions">
                  <p-button
                    icon="pi pi-pencil"
                    [text]="true"
                    [rounded]="true"
                    severity="secondary"
                    size="small"
                    (onClick)="onEditList(list, $event)"
                    pTooltip="Modifier"
                  />
                  @if (!list.isSystemList) {
                    <p-button
                      icon="pi pi-trash"
                      [text]="true"
                      [rounded]="true"
                      severity="danger"
                      size="small"
                      (onClick)="onDeleteList(list, $event)"
                      pTooltip="Supprimer"
                    />
                  }                                    
                </div>
              </div>
            </ng-template>

            <div class="card-content">
              <h3 class="list-title">{{ list.title }}</h3>
              
              @if (list.description) {
                <p class="list-description">{{ list.description }}</p>
              }
              
              <div class="list-meta">
                <span class="movie-count">
                  <i class="pi pi-film"></i>
                  {{ list.moviesCount }} film{{ list.moviesCount > 1 ? 's' : '' }}
                </span>
                <span class="created-date">
                  <i class="pi pi-calendar"></i>
                  {{ list.createdAt | date:'dd/MM/yyyy' }}
                </span>
              </div>
            </div>

            <ng-template pTemplate="footer">
              <div class="card-footer">
                <p-button
                  label="Voir les films"
                  icon="pi pi-arrow-right"
                  [text]="true"
                  styleClass="view-list-btn"
                />
              </div>
            </ng-template>
          </p-card>
        }
      </div>
    } @else {
      <div class="empty-state">
        <i class="pi pi-inbox"></i>
        <h2>Aucune liste pour le moment</h2>
        <p>Créez votre première liste pour organiser vos films préférés</p>
        
        @if (isAuthenticated()) {
          <p-button
            label="Créer ma première liste"
            icon="pi pi-plus"
            (onClick)="onCreateList()"
            styleClass="create-first-list-btn"
          />
        } @else {
          <p-button
            label="Se connecter"
            icon="pi pi-sign-in"
            (onClick)="onLogin()"
          />
        }
      </div>
    }
  }
</div>