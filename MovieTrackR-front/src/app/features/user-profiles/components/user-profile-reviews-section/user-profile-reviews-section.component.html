<section class="user-reviews-section">
  <!-- Section Header -->
  <div class="section-header">
    <h2>
      <i class="pi pi-star"></i>
      Critiques
    </h2>

    <div class="section-filters">
      <div class="filter-item">
        <span class="filter-label">Trier par</span>
        <p-select
          [options]="sortOptions"
          optionLabel="label"
          optionValue="value"
          [ngModel]="sort()"
          (onChange)="onSortChange($event.value)"
          styleClass="filter-select"
        />
      </div>

      <div class="filter-item">
        <span class="filter-label">Filtrer par note</span>
        <p-select
          [options]="ratingOptions"
          optionLabel="label"
          optionValue="value"
          [ngModel]="ratingFilter()"
          (onChange)="onRatingFilterChange($event.value)"
          styleClass="filter-select"
          placeholder="Toutes les notes"
        />
      </div>
    </div>
  </div>

  <!-- Loading -->
  @if (loading()) {
    <div class="section-loading">
      <p-progressSpinner strokeWidth="3" animationDuration="1s" />
    </div>
  } @else {
    <!-- Error -->
    @if (error()) {
      <div class="error-message">
        <i class="pi pi-exclamation-circle"></i>
        <span>{{ error() }}</span>
      </div>
    }

    <!-- Empty State -->
    @if (!error() && reviews().length === 0) {
      <div class="empty-state">
        <i class="pi pi-star"></i>
        <p>Aucune critique pour le moment.</p>
      </div>
    }

    <!-- Reviews List -->
    @if (!error() && reviews().length > 0) {
      <div class="reviews-list">
        @for (review of reviews(); track review.id) {
          <app-review-card 
            [review]="review"
            (edit)="onEdit()"
            (delete)="onDelete()"
          />
        }
      </div>

      @if (totalCount() > pageSize()) {
        <div class="paginator-wrapper">
          <p-paginator
            [rows]="pageSize()"
            [totalRecords]="totalCount()"
            [first]="(currentPage() - 1) * pageSize()"
            [rowsPerPageOptions]="[5, 10, 20]"
            (onPageChange)="onPageChange($event)"
            styleClass="custom-paginator"
          />
        </div>
      }
    }
  }
</section>